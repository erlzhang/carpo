.container.mt-4
  .row.mt-5
    - @books.each do |book|
      .col-md-3.mb-3.book-col
        .card.book-card.border-light
          = link_to manage_book_path(book), :class => "d-block w-100 h-100" do
            .card-body.d-flex.flex-column
              %h4.card-title= book.title
              %p.card-text.text-secondary.flex-1= truncate(book.description, length: 50, omission: "...")
              %small.text-muted
                更新于
                = last_updated(book)
          - unless book.posts.count > 0
            = link_to "", manage_book_path(book), "data-remote" => "true", :method => :delete, :class => 'close-icon delete-book'
    .col-md-3.mb-3.add-book-col{:class => current_user.author.can_create_book? ? "" : "d-none"}
      = link_to "#", "data-toggle" => "modal", :id => "btnNewBook", "data-target" => "#newBookModal" do
        .card.book-card.d-table.w-100.border-light
          .card-body.text-center.d-table-cell.h-100.align-middle
            .card-book-plus
              %span.plus-col
              %span.plus-row
.modal.fade#newBookModal{:role => "dialog", "aria-labelledby" => "btnNewBook", "aria-hidden" => "true"}
  .modal-dialog{:role => "document"}
    .modal-content
      .modal-header
        %h5.modal-title 新建书籍
      = form_for @book, :url => manage_books_path, :remote => true do |f|
        .modal-body
          .form-group
            = f.label :title, "书名"
            = f.text_field :title, :class => input_class(@book, :title)
            - if is_invalid?(@book, :title)
              = invalid_message(@book, :title)
          .form-group
            = f.label :description, "摘要"
            = f.text_area :description, :class => 'form-control', :rows => "5"
        .modal-footer
          = f.submit "提交", :class => 'btn btn-primary'

= javascript_include_tag "manage/books"
        

